<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>App Engine and httplib2</title>
  <meta name="description" content="The 1.1.9 release of the App Engine SDK includes support for httplib, urllib and urllib2. This is great since httplib2 depends on httlib. So far I&#39;ve only fo...">
  <meta name="google-site-verification" content="vZSL2JjLp0S_VXH743XRWWgko2D6B124A8pUAqT4FFk" />

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="https://bitworking.org/news/2009/02/app-engine-and-httplib2">
  <link rel="alternate" type="application/atom+xml" title="BitWorking" href="/news/feed/">
  <link rel="author" href="/about/">
  <link href="https://bitworking.org/u/webmention" rel="webmention" />
  <script async defer src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_CHTML'></script>
  <meta name="twitter:site"    content="@bitworking">
  <meta name="twitter:creator" content="@bitworking">
  <meta name="twitter:title"   content="App Engine and httplib2">
  <meta name="twitter:description" content="  
The 
 1.1.9 release of the App Engine SDK includes support for httplib, urllib and urllib2. 
This is great since httplib2 depends on httlib. 
So far I've only found
one problem, which is that httplib2 presumes that httplib returns all headers in lower case, and 
have 
already committed a fix to httplib2 for that. The change is currently in trunk and will appear
in the next release.


Setting up is easy, just pull the httplib2 directory into your project.


The nice part is that you can hook up httplib2 to 
the memcache
support in App Engine very easily:

import wsgiref.handlers
from google.appengine.ext import webapp

">
  <meta name="twitter:card"  content="summary">
  <meta name="twitter:image" content="https://bitworking.org/images/newlogo.png">

  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-1974123-1', 'auto');
  ga('send', 'pageview');

</script>
  

  
</head>


  <body>

    <header class="site-header" role="banner">

  <div class="wrapper">
    
    
    <a class="site-title" href="/">
      <img src="https://bitworking.org/images/newlogo.png" >
      BitWorking
    </a>
  
    
      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
              <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
              <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          
            
            
            <a class="page-link" href="/about/">About</a>
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
        </div>
      </nav>
    
  </div>
</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">App Engine and httplib2</h1>
    <p class="post-meta">
      <a class="u-url" href="/news/2009/02/app-engine-and-httplib2">
        <time datetime="2009-02-10T00:00:00-05:00" itemprop="datePublished" class="dt-published">
          
          Feb 10, 2009
        </time>
      </a>
      â€¢ <a rel="author me" class="p-author h-card" href="/about"> <span itemprop="author"
          itemscope itemtype="http://schema.org/Person">
          <img class="u-photo" src="/images/joe2016.jpg" alt="" style="height: 16px; border-radius: 8px; margin-right: 4px;" />
          <span
            itemprop="name">Joe Gregorio</span></span></a>
      </p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
      <p>
The <a href="http://googleappengine.blogspot.com/2009/02/sdk-version-119-released.html">
 1.1.9 release of the App Engine SDK includes support for httplib, urllib and urllib2</a>. 
This is great since <a href="http://code.google.com/p/httplib2/">httplib2</a> depends on httlib. 
So far I've only found
one problem, which is that httplib2 presumes that httplib returns all headers in lower case, and 
<a href="http://code.google.com/p/httplib2/source/detail?r=276">have 
already committed a fix to httplib2 for that</a>. The change is currently in trunk and will appear
in the next release.
</p>
<p>
Setting up is easy, just pull the httplib2 directory into your project.
</p>
<p>
The nice part is that you can hook up httplib2 to 
the <a href="http://code.google.com/appengine/docs/python/memcache/">memcache</a>
support in App Engine very easily:
</p>
<pre class="prettyprint">import wsgiref.handlers
from google.appengine.ext import webapp

import httplib2
from google.appengine.api.memcache import Client

mem = Client()
http = httplib2.Http(mem)  

class MainHandler(webapp.RequestHandler):

  def get(self):
    
    headers, body = http.request("http://example.org/")

    self.response.headers['content-type'] = "text/plain"
    self.response.out.write("Reported status = %d\n" % headers.status)
    self.response.out.write(headers)
    self.response.out.write("\n\n")
    self.response.out.write(body)
</pre>
<p>
The actual utility of httplib2 goes down on App Engine since 
the system that URLFetch runs through is an HTTP 1.1 compliant
proxy and takes care of redirects and caching, but httplib2 
still provides benefits such as authentication
and lost update support. In addition you could supply a 
cache handler to httplib2 that persisted the cached pages
to the datastore instead of memcache. 
</p>
  <div class="commentContent" id="X1">
    Maybe a little OT, but are there any plans to propose httplib2 for Python's stdlib?
    <p class="commentByLine">Posted by
       <a href="http://importskynet.blogspot.com">Eduardo Padoan</a> on <a href="#X1" title="2009-02-10T12:45:50.647010">2009-02-10</a>
    </p>
</div><div class="commentContent" id="X2">
    Eduardo,<br />
<p>I did some work on getting httplib2 into the stdlib in the past, but haven't had the personal bandwidth to pursue it.</p>
    <p class="commentByLine">Posted by
       <a href="http://bitworking.org">Joe</a> on <a href="#X2" title="2009-02-10T12:54:17.591801">2009-02-10</a>
    </p>
</div><div class="commentContent" id="X3">
    Very good news indeed.  This was the first question I asked when I saw urllib,urllib2, and httplib had landed in GAE.
    <p class="commentByLine">Posted by
       <a href="http://blogs.law.harvard.edu/pkeane">Peter Keane</a> on <a href="#X3" title="2009-02-10T14:54:50.501791">2009-02-10</a>
    </p>
</div><div class="commentContent" id="X4">
    "The change is currently in trunk and will appear in the next release". Next release of httplib, but when will it be in GAE?

In a similar vein, the first thing I thought when I noticed support for urllib2 and httplib was "great, I get to set timeouts on outbound HTTP requests". Except it's a 2.6 addition and GAE seems to still be on 2.5.2... :-(
    <p class="commentByLine">Posted by
       <a href="http://stage.vambenepe.com/">William Vambenepe</a> on <a href="#X4" title="2009-02-11T04:34:53.824198">2009-02-11</a>
    </p>
</div><div class="commentContent" id="X5">
    William,
  <p>I was talking about the next release of httplib<b>2</b>, not httplib which is a part of the Python standard library. 
</p>
    <p class="commentByLine">Posted by
       <a href="http://bitworking.org">Joe</a> on <a href="#X5" title="2009-02-11T09:16:22.976693">2009-02-11</a>
    </p>
</div><div class="commentContent" id="X6">
    Joe: yes, of course, sorry I read too fast. In any case, my point was to whine about the lack of timeout (added in 2.6) in the version of urllib/httplib2 supported by GAE.

But just today (or at least it was <a href="http://googleappengine.blogspot.com/2009/02/skys-almost-limit-high-cpu-is-no-more.html">announced</a> just today) you guys made an even better fix: no more "High CPU Requests". Avoiding these dreaded beasts is what was motivating my quest for timeout support.

I am a <a href="http://stage.vambenepe.com/archives/549">happy man</a> tonight because I can now emulate a long-running process on GAE. At least as a toy project. Thank you.
    <p class="commentByLine">Posted by
       <a href="http://stage.vambenepe.com/">William Vambenepe</a> on <a href="#X6" title="2009-02-13T04:14:28.643574">2009-02-13</a>
    </p>
</div>
  

  </div>

  <script type="text/javascript" charset="utf-8">
    fetch('/u/mentions').then(function(resp) {
      if (!resp.ok) {
        return
      }
      resp.text().then(function(text) {
        document.getElementById('mentions').innerHTML = text;
      });
    });
  </script>
  <div id=mentions>
  </div>

  
    

  <div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'https://bitworking.org/news/2009/02/app-engine-and-httplib2';
      this.page.identifier = 'https://bitworking.org/news/2009/02/app-engine-and-httplib2';
    };

    (function() {
      var d = document, s = d.createElement('script');

      s.src = 'https://bitworking-1.disqus.com/embed.js';

      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


  
</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    
    <div class="PageNavigation">
      
      <a class="prev" href="/news/2009/02/webhooks">&laquo;
        WebHooks</a>
      
      
      <a class="next"
        href="/news/2009/02/rdu-app-engine-hackathon">RDU App Engine Hackathon? &raquo;</a>
      
    </div>
    

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>
            
              BitWorking
            
            </li>
            
            <li><a rel=me class="u-email" href="mailto:joe@bitworking.org">joe@bitworking.org</a></li>
            
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/jcgregorio" rel=me><span class="icon icon--github"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">jcgregorio</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/bitworking" rel=me><span class="icon icon--twitter"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">bitworking</span></a>

          </li>
          

          <li>
            <a href="https://plus.google.com/+JoeGregorio" rel=me>
              <svg enable-background="new 0 0 128 128" height="16px" viewBox="0 0 128 128" width="16px" xml:space="preserve">
                <circle cx="64" cy="64" fill="gray" r="64"/>
                <path d="M49.424,97.875c-19.018,0-34.491-15.193-34.491-33.874c0-18.68,15.473-33.875,34.491-33.875 c8.318,0,16.354,2.952,22.624,8.309l-8.771,9.899c-3.838-3.279-8.758-5.086-13.853-5.086c-11.652,0-21.13,9.31-21.13,20.752 c0,11.441,9.479,20.75,21.13,20.75c9.858,0,16.311-4.723,18.407-13.197H49.587V58.432h32.347v6.562 C81.934,84.659,68.869,97.875,49.424,97.875z"
                fill="#FFFFFF"/>
                <polygon fill="#FFFFFF" points="117.934,58.438
                107.934,58.438 107.934,48.438 99.934,48.438 99.934,58.438
                89.934,58.438     89.934,66.438 99.934,66.438 99.934,76.438
                107.934,76.438 107.934,66.438 117.934,66.438   "/>
              </svg>
              <span class="username">JoeGregorio</span></a>
          </li>
        </ul>
      </div>

      <div class="h-card footer-col footer-col-3">
        <p class="p-note">Joe Gregorio - REST, Web, Python, Go, APIs, Dad, Husband, Maker, or any linear combination of such. Googler.
</p>
        <a class="p-name u-url" href="https://bitworking.org" style="display: none"><img
          class="u-photo" src="/images/joe2016.jpg" alt="" />Joe Gregorio</a>
        <a rel=me class="u-email" href="mailto:joe@bitworking.org">joe@bitworking.org</a>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
